<div class="text-center text-2xl font-bold text-white mb-2">
  Gráfico Logística
</div>

<div class="w-[530px] mx-auto p-1">
  <div class="flex flex-col md:flex-row gap-4 mb-4">
    <div class="flex-1">
      <mat-form-field appearance="fill" class="w-full">
        <mat-label class="text-black">Selecciona un tipo</mat-label>
        <mat-select
          [(value)]="tipoSeleccionado"
          (selectionChange)="onTipoSeleccionado($event.value)"
          (openedChange)="onTipoOpened($event)"
        >
          <mat-option>
            <input
              matInput
              placeholder="Buscar tipo..."
              [(ngModel)]="filtroTipo"
              (click)="$event.stopPropagation()"
              class="w-full px-2 py-1 border border-blue-900 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
          </mat-option>
          <mat-option *ngFor="let tipo of tiposFiltrados" [value]="tipo">
            {{ tipo }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <div class="flex-1">
      <mat-form-field appearance="fill" class="w-full">
        <mat-label class="text-black">Selecciona un ítem</mat-label>
        <mat-select
          [(ngModel)]="equipoSeleccionado"
          [disabled]="!tipoSeleccionado"
          (selectionChange)="onEquipoSeleccionado($event.value)"
          (openedChange)="onEquipoOpened($event)"
        >
          <mat-option>
            <input
              type="text"
              [(ngModel)]="equipoFiltro"
              placeholder="Buscar ítem..."
              (click)="$event.stopPropagation()"
              class="w-full px-2 py-1 border border-blue-900 rounded focus:outline-none 
                     focus:ring-2 focus:ring-blue-500"
            />
          </mat-option>

          <mat-option *ngFor="let equipo of equiposFiltrados" [value]="equipo.nombre">
            {{ equipo.nombre }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>

  </div>

  <div *ngIf="chartData.labels?.length" class="w-[500px] mx-auto p-4">
    <canvas baseChart
            [data]="chartData"
            [type]="pieChartType"
            [options]="chartOptions">
    </canvas>
  </div>

  <div *ngIf="!chartData.labels?.length && tipoSeleccionado && equipoSeleccionado" class="text-yellow-400 text-center mt-4">
    No hay datos disponibles para la selección actual.
  </div>
</div>